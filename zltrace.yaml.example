# zltrace 配置文件示例
# 复制此文件为 zltrace.yaml 并根据需要修改

# ========== 追踪系统配置 ==========
trace:
  # 是否启用追踪（总开关）
  enabled: true

  # 服务名称（用于追踪系统中标识本服务）
  # 可以通过环境变量 SERVICE_NAME 或 APP_NAME 覆盖
  service_name: my_service

  # 采样配置
  sampler:
    # 采样类型: always_on, never, traceid_ratio, parent_based
    # - always_on: 全量采样（100%）
    # - never: 不采样
    # - traceid_ratio: 按比率采样（需要设置 ratio）
    # - parent_based: 基于父 span 决定
    type: always_on
    # 采样比率（0.0 - 1.0），仅当 type=traceid_ratio 时生效
    ratio: 1.0

  # Exporter 配置（决定追踪数据发送到哪里）
  exporter:
    # 导出类型: otlp, stdout, none
    # - otlp: 发送到追踪系统（SkyWalking、Jaeger 等）
    # - stdout: 输出到日志（降级模式，不发送到追踪系统）
    # - none: 不发送追踪数据（只生成 trace_id）
    type: stdout

    # OTLP gRPC 配置（type=otlp 时生效）
    otlp:
      # 追踪系统服务地址（SkyWalking OAP、Jaeger 等）
      endpoint: localhost:4317
      # 连接超时时间（秒）
      timeout: 10
      # 是否使用 insecure 连接（开发环境设置为 true）
      insecure: true

    # 最大队列大小
    max_queue_size: 2048

  # 批量处理配置
  batch:
    # 批量发送的最大 span 数量
    batch_size: 512
    # 批量发送的超时时间（秒）
    timeout: 5
    # 最大队列大小
    max_queue_size: 2048

# ========== 配置文件加载顺序 ==========
# zltrace 会按以下顺序查找配置文件：
# 1. ./zltrace.yaml (当前目录)
# 2. $ZLTRACE_CONFIG 环境变量指定的路径
# 3. /etc/zltrace/config.yaml (系统配置目录)
# 4. 如果都没有找到，使用默认配置

# ========== 环境变量 ==========
# - SERVICE_NAME: 服务名称（覆盖配置文件中的 service_name）
# - APP_NAME: 应用名称（备用， SERVICE_NAME 优先）
# - ZLTRACE_CONFIG: 配置文件路径
